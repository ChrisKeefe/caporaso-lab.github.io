
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Assignment details &#8212; bioinformatics@nau</title>
    <link rel="stylesheet" href="../../static/haiku.css" type="text/css" />
    <link rel="stylesheet" href="../../static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="../../" src="../../static/documentation_options.js"></script>
    <script src="../../static/jquery.js"></script>
    <script src="../../static/underscore.js"></script>
    <script src="../../static/doctools.js"></script>
    <script src="../../static/language_data.js"></script>
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Application presentations" href="application_presentations.html" />
    <link rel="prev" title="Books and recommended references" href="books_and_links.html" /> 
  </head><body>
      <div class="header" role="banner"><h1 class="heading"><a href="../../index.html">
          <span>bioinformatics@nau</span></a></h1>
        <h2 class="heading"><span>Assignment details</span></h2>
      </div>
      <div class="topnav" role="navigation" aria-label="top navigation">
      
        <p>
        «&#160;&#160;<a href="books_and_links.html">Books and recommended references</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="../../index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="application_presentations.html">Application presentations</a>&#160;&#160;»
        </p>

      </div>
      <div class="content" role="main">
        
        
  <div class="section" id="assignment-details">
<span id="id1"></span><h1>Assignment details<a class="headerlink" href="#assignment-details" title="Permalink to this headline">¶</a></h1>
<div class="section" id="programming-assignment-3-assembling-an-overlap-table">
<h2>Programming assignment 3: Assembling an overlap table<a class="headerlink" href="#programming-assignment-3-assembling-an-overlap-table" title="Permalink to this headline">¶</a></h2>
<p>In this assignment you will assemble an overlap table that could be used in the de novo assembly of a genome from a set of short sequencing reads.</p>
<p>Create a new python file named <code class="docutils literal notranslate"><span class="pre">prog3_&lt;userid&gt;.py</span></code>, where <code class="docutils literal notranslate"><span class="pre">userid</span></code> is replaced with your NAU user id. You must also define <code class="docutils literal notranslate"><span class="pre">userid=&lt;userid&gt;</span></code> (again where &lt;userid&gt; is replaced with your NAU user id) in your script so that it can be imported into other code. Any deviations from these instructions <strong>will result in a zero on this assignment</strong>!</p>
<dl class="simple">
<dt>In this file, define a function that takes a list of (sequence id, sequence) tuples and a substitution matrix. This function should return:</dt><dd><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">overlap_matrix</span></code>: a 2D list where each internal list <code class="docutils literal notranslate"><span class="pre">i</span></code>  represents a vector of the number of overlapping positions between sequence <code class="docutils literal notranslate"><span class="pre">i</span></code> and every sequence in the input sequence collection;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">repeat_counts</span></code>: a list containing the number of times each sequence is repeated in its entirety.</p></li>
</ul>
</dd>
</dl>
<p>The overlap score should be <code class="docutils literal notranslate"><span class="pre">-1</span></code> for the overlap between a sequence and itself or any other identical repeat. (For identical repeat I use the definition of python string equality, so if <code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">==</span> <span class="pre">b</span></code>, <code class="docutils literal notranslate"><span class="pre">a</span></code> is an identical repeat of <code class="docutils literal notranslate"><span class="pre">b</span></code> and vice versa.)</p>
<p>The function should be of the form:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">compute_overlaps</span><span class="p">(</span><span class="n">seqs</span><span class="p">,</span><span class="n">substitution_matrix</span><span class="p">):</span>
    <span class="c1"># do a bunch of work</span>
    <span class="k">return</span> <span class="n">overlap_matrix</span><span class="p">,</span> <span class="n">repeat_counts</span>
</pre></div>
</div>
<p>You should additionally define a 2D dictionary <code class="docutils literal notranslate"><span class="pre">assembly_substitution_matrix</span></code> that contains scores for substitutions between the nucleotide bases. You will define the values in this martix to optimize them for this task.</p>
<p>Additionally, I want you to benchmark your script against several large collections of sequences, and plot the run time of each. You can get the run time by using the <code class="docutils literal notranslate"><span class="pre">time</span></code> command which is built-in to Unix/Linux and Mac OS X. If you are running Windows on your laptop you can either do this portion on the Amazon Cloud or in the Computer Science lab in the engineering building. It may be useful for you to generate a command line interface for your script to achieve this portion of the assignment. The <code class="docutils literal notranslate"><span class="pre">MinimalFastaParser</span></code> function in PyCogent will additionally be useful here: given an open fasta file, this returns a list (really a generator) of (sequence_id, sequence) tuples, which is the input expected by <code class="docutils literal notranslate"><span class="pre">compute_overlaps</span></code>.</p>
<p>Download the files here for your benchmark analysis <code class="xref download docutils literal notranslate"><span class="pre">here</span></code> For this component of the assignment, I want you to turn in a scatter plot where the x axis is the number of sequences in the input file and the y axis is the runtime of your script in seconds.</p>
<dl class="simple">
<dt>Hints:</dt><dd><ul class="simple">
<li><p>You can optionally re-use the <code class="docutils literal notranslate"><span class="pre">sw_align</span></code> function generated in programming assignment 1. So everyone has access to a single implementation, you can use the version included <code class="xref download docutils literal notranslate"><span class="pre">here</span></code> To use this, place the file in the same directory as your <code class="docutils literal notranslate"><span class="pre">prog3_&lt;userid&gt;.py</span></code> and add the line <code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">sw_align</span> <span class="pre">import</span> <span class="pre">sw_align</span></code> to your script. If you choose not to use this function, be sure to include any necessary code in your <code class="docutils literal notranslate"><span class="pre">prog3_&lt;userid&gt;.py</span></code> file – no other imports (unless from the python standard library or PyCogent) will be allowed (i.e., it needs to run on my laptop).</p></li>
<li><p>Your substitution matrix should be optimized so mismatches are scored so poorly that in practice they never show up.</p></li>
<li><p>You’ll want to impose a high gap penalty so in practice gaps never show up.</p></li>
<li><p>Think about things you can do to optimize your code to reduce the run time. This may come up on the final…</p></li>
</ul>
</dd>
</dl>
<p><code class="xref download docutils literal notranslate"><span class="pre">This</span> <span class="pre">script</span></code> will allow you to test your code. This is a partial set of the tests that I will run. Passing all 4 of these tests will guarantee you at least a 40% on this homework assignment. After downloading this script to the same directory as your homework assignment you can run the tests as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">test_prog3</span><span class="o">.</span><span class="n">py</span> <span class="n">prog3_jgc53</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>(Where my script is named <code class="docutils literal notranslate"><span class="pre">prog3_jgc53.py</span></code>.)</p>
</div>
<div class="section" id="programming-assignment-2-constructing-a-phylogenetic-tree">
<h2>Programming assignment 2: Constructing a phylogenetic tree<a class="headerlink" href="#programming-assignment-2-constructing-a-phylogenetic-tree" title="Permalink to this headline">¶</a></h2>
<p>In this assignment you will make use of the PyCogent software package to automate the process of constructing a phylogenetic tree from a set of genes.</p>
<p>Create a new python file named <code class="docutils literal notranslate"><span class="pre">prog2_&lt;userid&gt;.py</span></code>, where <code class="docutils literal notranslate"><span class="pre">userid</span></code> is replaced with your NAU user id. You must also define <code class="docutils literal notranslate"><span class="pre">userid=&lt;userid&gt;</span></code> (again where &lt;userid&gt; is replaced with your NAU user id) in your script so that it can be imported into other code. Any deviations from these instructions <strong>will result in a zero on this assignment</strong>!</p>
<p>In this file, define a function that takes a list of queries to be run against NCBI and a list of query labels to label the results of each query in the final tree, and returns a phylogenetic tree derived from aligned representatives of those queries. This function should optionally take a parameter <code class="docutils literal notranslate"><span class="pre">n</span></code> which defines how many randomly chosen representative sequences should be chosen for each of the queries. The default value for <code class="docutils literal notranslate"><span class="pre">n</span></code> should be 5. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">obtain_sequences_and_build_tree</span><span class="p">(</span><span class="n">queries</span><span class="p">,</span><span class="n">query_labels</span><span class="p">,</span><span class="n">n</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
    <span class="c1"># do a bunch of work</span>
    <span class="k">return</span> <span class="n">tree</span>
</pre></div>
</div>
<p>You should filter any sequences that have one or more <code class="docutils literal notranslate"><span class="pre">N</span></code> characters in them, and each sequence id should begin with the query label corresponding to that sequence.</p>
<p><code class="docutils literal notranslate"><span class="pre">tree</span></code> should be a PyCogent <code class="docutils literal notranslate"><span class="pre">PhyloNode</span></code> object. The function handle must look exactly like the one above (remember - the tests are automated so deviations from that will result in a zero!).</p>
<dl>
<dt>Items to turn in:</dt><dd><ul>
<li><p>Your <code class="docutils literal notranslate"><span class="pre">.py</span></code> file, by e-mail.</p></li>
<li><p>Apply your function as follows and e-mail me a newick formatted tree file named <code class="docutils literal notranslate"><span class="pre">prog2_&lt;userid&gt;.tre</span></code>, where <code class="docutils literal notranslate"><span class="pre">userid</span></code> is replaced with your NAU user id. Be sure your tree includes distances (i.e., branch lengths):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">obtain_sequences_and_build_tree</span><span class="p">(</span>
     <span class="p">[</span><span class="s1">&#39;&quot;small subunit rRNA&quot;[ti] AND archaea[orgn]&#39;</span><span class="p">,</span>
      <span class="s1">&#39;&quot;small subunit rRNA&quot;[ti] AND bacteria[orgn]&#39;</span><span class="p">,</span>
      <span class="s1">&#39;&quot;small subunit rRNA&quot;[ti] AND eukarya[orgn]&#39;</span><span class="p">],</span>
     <span class="p">[</span><span class="s1">&#39;A: &#39;</span><span class="p">,</span><span class="s1">&#39;B: &#39;</span><span class="p">,</span><span class="s1">&#39;E: &#39;</span><span class="p">],</span>
     <span class="n">n</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ul>
</dd>
<dt>Hints:</dt><dd><ul class="simple">
<li><p><a class="reference external" href="http://dl.dropbox.com/u/2868868/pycogent_160dev_docs/cookbook/building_a_tree_of_life.html">This page</a> will help.</p></li>
<li><p>The Amazon QIIME EC2 instance has PyCogent, muscle, and FastTree preinstalled. Working there will save you a lot of time on software installation.</p></li>
<li><p>Remember that you can call <code class="docutils literal notranslate"><span class="pre">dir()</span></code> on an object to find out what methods are available to that object. One of the methods associated with your tree object will help you generate a newick formatted tree.</p></li>
</ul>
</dd>
</dl>
<p><code class="xref download docutils literal notranslate"><span class="pre">This</span> <span class="pre">script</span></code> will allow you to test your code. This is a partial set of the tests that I will run. Passing all 5 of these tests will guarantee you at least a 50% on this homework assignment. After downloading this script to the same directory as your homework assignment you can run the tests as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">test_prog2</span><span class="o">.</span><span class="n">py</span> <span class="n">prog2_jgc53</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>(Where my script is named <code class="docutils literal notranslate"><span class="pre">prog2_jgc53.py</span></code>.)</p>
</div>
<div class="section" id="programming-assignment-1-i-e-modified-exercise-41-44-extra-credit">
<h2>Programming assignment 1 (i.e., Modified exercise 41-44): Extra credit<a class="headerlink" href="#programming-assignment-1-i-e-modified-exercise-41-44-extra-credit" title="Permalink to this headline">¶</a></h2>
<p>Create a new python file named <code class="docutils literal notranslate"><span class="pre">prog1ec_&lt;userid&gt;.py</span></code>, where <code class="docutils literal notranslate"><span class="pre">userid</span></code> is replaced with your NAU user id. For example, mine is called <code class="docutils literal notranslate"><span class="pre">prog1ec_jgc53.py</span></code>. Name it exactly like this (including case!). You must also define <code class="docutils literal notranslate"><span class="pre">userid=&lt;userid&gt;</span></code> (again where &lt;userid&gt; is replaced with your NAU user id) in your script so that it can be imported into other code. Any deviations from these instructions <strong>will result in a zero on this assignment</strong>!</p>
<p>Define a function of the form:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">transcribe</span><span class="p">(</span><span class="n">dna</span><span class="p">)</span>
</pre></div>
</div>
<p>which simulates transcription of a string passed as <code class="docutils literal notranslate"><span class="pre">dna</span></code> and returns the resulting sequence as a string.</p>
<p>Define another function of the form:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">rc</span><span class="p">(</span><span class="n">dna</span><span class="p">)</span>
</pre></div>
</div>
<p>which reverse complements a string passed as <code class="docutils literal notranslate"><span class="pre">dna</span></code> and returns the resulting sequence as a string.</p>
<p>Your python file should also define a command line interface that allows users to pass a single sequence followed by an operation (<code class="docutils literal notranslate"><span class="pre">t</span></code> for transcribe or <code class="docutils literal notranslate"><span class="pre">rc</span></code> for reverse complement). The script should apply the appropriate operation and print the result to the terminal. If the user passes something other than <code class="docutils literal notranslate"><span class="pre">t</span></code> or <code class="docutils literal notranslate"><span class="pre">rc</span></code>, for example <code class="docutils literal notranslate"><span class="pre">xyz</span></code>, the script should print <code class="docutils literal notranslate"><span class="pre">Unknown</span> <span class="pre">operation:</span> <span class="pre">xyz.</span></code></p>
<p>You should be able to call your script as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">prog1ec_jgc53</span><span class="o">.</span><span class="n">py</span> <span class="n">ACCGT</span> <span class="n">t</span>
<span class="n">python</span> <span class="n">prog1ec_jgc53</span><span class="o">.</span><span class="n">py</span> <span class="n">ACCGT</span> <span class="n">rc</span>
</pre></div>
</div>
<p>Validate your script by downloading <code class="xref download docutils literal notranslate"><span class="pre">this</span> <span class="pre">script</span></code> by saving it to the same directory as your script and running the command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">test_prog1ec</span><span class="o">.</span><span class="n">py</span> <span class="n">prog1ec_jgc53</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>When your script is working correctly the output should end with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">----------------------------------------------------------------------</span>
<span class="n">Ran</span> <span class="mi">5</span> <span class="n">tests</span> <span class="ow">in</span> <span class="mf">0.117</span><span class="n">s</span>

<span class="n">OK</span>
</pre></div>
</div>
<p>There are five tests implemented here, and each test is worth one extra credit point toward programming assignment 1. These are the same tests that I will run when you turn your assignment in.</p>
</div>
<div class="section" id="modified-exercise-41-44">
<h2>Modified exercise 41-44<a class="headerlink" href="#modified-exercise-41-44" title="Permalink to this headline">¶</a></h2>
<p>This exercise will be broken apart for the CS students and the Bio students. You should start this exercise with my Needleman-Wunsch python implementation presented here. If you feel that you should be doing the assignment assigned to the other group, e-mail me by Friday Oct 7th at the latest with an explanation of why and I will consider your request.</p>
<p>Begin with the Needleman-Wunsch implementation in the <a class="reference external" href="../lectures/lecture11.html">lecture 11 notes</a>.</p>
<div class="section" id="all-students">
<h3>All students<a class="headerlink" href="#all-students" title="Permalink to this headline">¶</a></h3>
<p>Add a new function with this <cite>exact</cite> form:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">nw_align</span><span class="p">(</span><span class="n">sequence1</span><span class="p">,</span><span class="n">sequence2</span><span class="p">,</span><span class="n">substitution_matrix</span><span class="p">)</span>
</pre></div>
</div>
<p>This function should return, in this order, the aligned sequence 1 as a string, the aligned sequence 2 as a string, and the score of the global alignment.</p>
<p>Next, add a command line interface so users can call this with arbitrary sequences from the command line and have the aligned sequences and the score print to the screen.</p>
<p>Save this script named as follows replacing <code class="docutils literal notranslate"><span class="pre">&lt;userid&gt;</span></code> with your NAU user id <code class="docutils literal notranslate"><span class="pre">prog1_&lt;userid&gt;.py</span></code>. For example, my file would be called <code class="docutils literal notranslate"><span class="pre">prog1_jgc53.py</span></code> because my NAU id is <code class="docutils literal notranslate"><span class="pre">jgc53</span></code>.</p>
<p>Toward the top of the file define a variable <code class="docutils literal notranslate"><span class="pre">userid</span></code> that is set to your NAU user id. This is <cite>very important</cite> - you will receive a zero on this assignment if you do not do this. For me, this would look like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">userid</span> <span class="o">=</span> <span class="s2">&quot;jgc53&quot;</span>
</pre></div>
</div>
<p>To confirm that your script is formatted correctly, <code class="xref download docutils literal notranslate"><span class="pre">this</span> <span class="pre">script</span></code>. Place this script in the same directory as your homework assignment and run the following command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">validate_assignment_specifications</span><span class="o">.</span><span class="n">py</span> <span class="o">&lt;</span><span class="n">script_name</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Where <code class="docutils literal notranslate"><span class="pre">&lt;script_name&gt;</span></code> is replaced by the name of your script. For example, my command would look like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">validate_assignment_specifications</span><span class="o">.</span><span class="n">py</span> <span class="n">prog1_jgc53</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>You should get a message that three tests passed. If the message does not end with the following you have not formatted your homework correctly, and you will get a zero on the assignment:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">----------------------------------------------------------------------</span>
<span class="n">Ran</span> <span class="mi">3</span> <span class="n">tests</span> <span class="ow">in</span> <span class="mf">0.007</span><span class="n">s</span>

<span class="n">OK</span>
</pre></div>
</div>
</div>
<div class="section" id="bio-students">
<h3>Bio students<a class="headerlink" href="#bio-students" title="Permalink to this headline">¶</a></h3>
<p>In the script you created above, define a new function of the form:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">generate_random_score_distribution</span><span class="p">(</span><span class="n">query_sequence</span><span class="p">,</span><span class="n">subject_sequence</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">substitution_matrix</span><span class="p">)</span>
</pre></div>
</div>
<p>Which returns a list of <code class="docutils literal notranslate"><span class="pre">n</span></code> scores for aligning each of <code class="docutils literal notranslate"><span class="pre">n</span></code> random sequences of the same length as <code class="docutils literal notranslate"><span class="pre">query_sequence</span></code> against <code class="docutils literal notranslate"><span class="pre">subject_sequence</span></code>.</p>
<p>Next, define a function that takes a query sequence, a subject sequence, and a value <code class="docutils literal notranslate"><span class="pre">n</span></code> with this form:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fraction_better_or_equivalent_alignments</span><span class="p">(</span><span class="n">query_sequence</span><span class="p">,</span><span class="n">subject_sequence</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">substitution_matrix</span><span class="p">)</span>
</pre></div>
</div>
<p>This function should call <code class="docutils literal notranslate"><span class="pre">generate_random_score_distribution</span></code> to generate a list of scores for random alignments. It should then compute the score for aligning <code class="docutils literal notranslate"><span class="pre">query_sequence</span></code> against <code class="docutils literal notranslate"><span class="pre">subject_sequence</span></code>. The return value of this function should be the number of random alignment scores that are better or equal to the actual alignment score divided by <code class="docutils literal notranslate"><span class="pre">n</span></code>.</p>
<p>Generate a length 100 subject sequence randomly. Next generate about 5 query sequences of varied lengths (around 3 to around 75), and log the results of comparing each query sequence to the subject sequence. Log the sequences and results in your programming notebook. Describe any general patterns that you notice. What do you think this means? Run this example on the alignment we worked through in class (query sequence: <code class="docutils literal notranslate"><span class="pre">HEAGAWGHEE</span></code>; subject sequence: <code class="docutils literal notranslate"><span class="pre">PAWHEAE</span></code>) and describe the results. How does this alignment compare to your randomly generated alignments? Justify your answer in your programming notebook.</p>
<dl class="simple">
<dt>Hints:</dt><dd><ul class="simple">
<li><p>In the Lecture 8 notes there is code illustrating how to generate a random sequence of bases at a given sequence length. Here we’re working with protein sequences, but the process is the same.</p></li>
<li><p>Running your fraction_better_alignments on the query and subject sequences below will go quicker if you hook this up to the command line interface of your script. Every time the script is called, run this analysis and include the results at the end.</p></li>
</ul>
</dd>
</dl>
</div>
<div class="section" id="cs-students">
<h3>CS students<a class="headerlink" href="#cs-students" title="Permalink to this headline">¶</a></h3>
<p>You will define a general function that can perform global (Needleman-Wunsch; NW) or local (Smith-Waterman; SW) alignments.</p>
<p>Define a new function, <code class="docutils literal notranslate"><span class="pre">generate_sw_and_traceback_matrices</span></code> with the following form:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">generate_sw_and_traceback_matrices</span><span class="p">(</span><span class="n">seq1</span><span class="p">,</span><span class="n">seq2</span><span class="p">,</span><span class="n">gap_penalty</span><span class="p">,</span><span class="n">substitution_matrix</span><span class="p">)</span>
</pre></div>
</div>
<p>The return value should be the dynamic programming matrix and the traceback matrix for a SW alignment.</p>
<p>Define a new function <code class="docutils literal notranslate"><span class="pre">sw_traceback</span></code> with the form:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sw_traceback</span><span class="p">(</span><span class="n">traceback_matrix</span><span class="p">,</span><span class="n">sw_matrix</span><span class="p">,</span><span class="n">seq1</span><span class="p">,</span><span class="n">seq2</span><span class="p">)</span>
</pre></div>
</div>
<p>This function should return aligned the aligned sequences in the order they were passed in and the alignment score.</p>
<p>Define a new function <code class="docutils literal notranslate"><span class="pre">align</span></code> with the following form:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">align</span><span class="p">(</span><span class="n">sequence1</span><span class="p">,</span><span class="n">sequence2</span><span class="p">,</span><span class="n">substitution_matrix</span><span class="p">,</span><span class="n">local</span><span class="p">)</span>
</pre></div>
</div>
<p>Where <code class="docutils literal notranslate"><span class="pre">local</span></code> is a boolean value. This function should return aligned_sequence1, aligned_sequence2, and the best alignment score. If <code class="docutils literal notranslate"><span class="pre">local==False</span></code>, an NW alignment should be performed. If <code class="docutils literal notranslate"><span class="pre">local==True</span></code> an SW alignment should be performed.</p>
<p>Hook this up to the command line interface so the user can optionally create a global or a local alignment.</p>
<dl class="simple">
<dt>Hints:</dt><dd><ul class="simple">
<li><p>In my <a class="reference external" href="http://dl.dropbox.com/u/2868868/cs299_slides_XCFGcsdFGGad/Lecture9.pptx.pdf">slides from lecture 9</a> I provide details on the differences between SW and NW initialization, scoring, and traceback.</p></li>
</ul>
</dd>
</dl>
</div>
</div>
<div class="section" id="modified-exercise-38">
<h2>Modified exercise 38<a class="headerlink" href="#modified-exercise-38" title="Permalink to this headline">¶</a></h2>
<p>For LPTHW modified exercise 38 I want you to find and review bioinformatics code (rather than some random code out on the internet).</p>
<p>For folks who are already comfortable with Python, start with PyCogent, QIIME, or any other bioinformatics python code you come across. Start <a class="reference external" href="http://pycogent.svn.sourceforge.net/viewvc/pycogent/trunk/cogent/">here for PyCogent</a> or <a class="reference external" href="http://qiime.svn.sourceforge.net/viewvc/qiime/trunk/qiime/">here for QIIME</a> (after clicking on a file name, click the <code class="docutils literal notranslate"><span class="pre">View</span></code> link under <code class="docutils literal notranslate"><span class="pre">Links</span> <span class="pre">to</span> <span class="pre">HEAD</span></code>). Record in your programming notebook which file(s) you work with.</p>
<p>For students who are just learning python, review in detail the sequence evolution script that we built in Lecture 8. Work through this until you can explain what <cite>each line</cite> is doing. Ideally work with a friend and explain the lines to each other. Then make some modifications to change the behavior. You can find that <a class="reference internal" href="lectures/lecture8.html#sequence-evolution-script"><span class="std std-ref">here</span></a>.</p>
</div>
<div class="section" id="blasting-through-the-kingdom-of-life">
<h2>BLASTing Through the Kingdom of Life<a class="headerlink" href="#blasting-through-the-kingdom-of-life" title="Permalink to this headline">¶</a></h2>
<p><strong>This assignment will be due in class on Tuesday Sept 27th. This is a graded homework assignment that must be turned in on paper (i.e., not digitally). Your answers must be typed, not hand-written, and formatted as in the example answers in</strong> <a class="reference download internal" download="" href="../../_downloads/ba47d6c3ab34c83cdc4e1232e2460d55/BTTKOL_students.pdf"><code class="xref download docutils literal notranslate"><span class="pre">this</span> <span class="pre">document</span></code></a> <strong>. Your name must appear at the top left of the first page.</strong> I will deduct points for deviations from these requirements.</p>
<p>In class on Tuesday Sept 20th I’ll give out assignments of which students will work with which two sequences. Everyone should work independently on this project: it’s OK to talk with other students about the project, but <strong>it is not OK look at each others results</strong>.</p>
<p>This assignment will go faster if you start by reviewing <a class="reference external" href="http://www.digitalworldbiology.com/BLAST/index.html">this tutorial</a>.</p>
<p>You can find your sequences <a class="reference external" href="http://www.digitalworldbiology.com/BLAST/62000sequences.html">here</a> and the list of assigned sequences <a class="reference download internal" download="" href="../../_downloads/d273d0d04601737b848f0f4dcab7cd80/BLASTing_assignments.txt"><code class="xref download docutils literal notranslate"><span class="pre">here</span></code></a> .</p>
<p>You should answer the questions posted <a class="reference download internal" download="" href="../../_downloads/ba47d6c3ab34c83cdc4e1232e2460d55/BTTKOL_students.pdf"><code class="xref download docutils literal notranslate"><span class="pre">here</span></code></a> for each of your two sequences. Note that there are sample answers for an example sequence - you should format your answers as you see in the sample answers in this PDF (don’t forget the <cite>Information Source</cite>!).</p>
</div>
<div class="section" id="modified-exercise-36-adding-error-checking-to-our-sequence-processing-script">
<h2>Modified Exercise 36: Adding error checking to our sequence processing script<a class="headerlink" href="#modified-exercise-36-adding-error-checking-to-our-sequence-processing-script" title="Permalink to this headline">¶</a></h2>
<p>Read through Exercise 36, but don’t do the <cite>Homework</cite> section. Instead, do the following.</p>
<p>Start with the example script from lecture 5 (<a class="reference internal" href="lectures/lecture5.html#sequence-processing-script"><span class="std std-ref">see here</span></a>: use the last one included in lecture 5 with the <code class="docutils literal notranslate"><span class="pre">reverse_complement</span></code> and <code class="docutils literal notranslate"><span class="pre">transcribe</span></code> functions.)</p>
<p>We discussed several times that the <code class="docutils literal notranslate"><span class="pre">reverse_complement</span></code> function as implemented is wrong. Use a <code class="docutils literal notranslate"><span class="pre">for</span></code> loop to improve this: this script should print an error message to the terminal and exit without writing the output file if the input sequence contains any characters other than <code class="docutils literal notranslate"><span class="pre">A</span></code>, <code class="docutils literal notranslate"><span class="pre">C</span></code>, <code class="docutils literal notranslate"><span class="pre">G</span></code>, or <code class="docutils literal notranslate"><span class="pre">T</span></code>.</p>
<p>Advanced python users: try reimplementing this function with a dictionary and with string’s <code class="docutils literal notranslate"><span class="pre">translate</span></code> method. Which implementation is most efficient if you try to process a lot (e.g., 100) very large strings (e.g., length 1,000,000)? Back up your answer with data (hint: check out the <code class="docutils literal notranslate"><span class="pre">time</span></code> command) and log your results in your programming notebook. Check out the <code class="docutils literal notranslate"><span class="pre">choice</span></code> method in the <code class="docutils literal notranslate"><span class="pre">random</span></code> module - use this with a <code class="docutils literal notranslate"><span class="pre">for</span></code> loop to generate your string. Can you come up with any more efficient mechanisms for reverse complementing a string (I don’t have a specific example in mind here…)? What are some reasons why you might choose one implementation over another?</p>
<p>Log your modified script in your programming notebook by pasting the code in.</p>
<p><strong>E-mail me your programming notebook before class begins on Tuesday!</strong></p>
</div>
<div class="section" id="programming-noteboook-on-going-will-be-collected-several-times-through-out-the-semester">
<h2>Programming noteboook (on-going; will be collected several times through-out the semester)<a class="headerlink" href="#programming-noteboook-on-going-will-be-collected-several-times-through-out-the-semester" title="Permalink to this headline">¶</a></h2>
<p>The programming notebook is an electronic journal to keep track of your progress with learning python. The things that I’m looking for are notes on what you had difficulties with, what you had to look up along the way, and how you solved certain problems. As you move through the exercises you’ll undoubtedly run into the same issues again - if you have a record of how you previously solved a problem, looking back through this journal should help you. You are also expected to answer any <code class="docutils literal notranslate"><span class="pre">Extra</span> <span class="pre">Credit</span></code> questions that are raised in the LPTHW text in your programming notebook. I don’t, however, need to see all of the code snippets that you write for the exercises here.</p>
<p>I recommend that you keep notes in whatever program you’re comfortable with, provided that when I collect these you’ll be able to generate a PDF that you can send to me. Some choices might be MS Word, Google Docs, Evernote, Gedit (you’ll need to print to PDF), etc.</p>
<p>A few (random) times through-out the semester I’ll collect your programming notebooks in electronic form. I’ll review these and score them on completeness.</p>
<p>Here’s an example of what your notebook might look like for the first three exercises:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Exercise</span> <span class="mi">0</span> <span class="p">(</span><span class="mi">31</span> <span class="n">Aug</span> <span class="mi">2011</span><span class="p">)</span>

<span class="n">Installed</span> <span class="n">Gedit</span> <span class="ow">and</span> <span class="n">created</span> <span class="n">a</span> <span class="n">test</span> <span class="n">file</span><span class="o">.</span> <span class="n">Had</span> <span class="n">to</span> <span class="n">look</span> <span class="n">up</span> <span class="n">how</span> <span class="n">to</span> <span class="n">make</span> <span class="ow">and</span>
<span class="n">change</span> <span class="n">directories</span> <span class="n">on</span> <span class="n">the</span> <span class="n">web</span><span class="o">.</span> <span class="n">I</span> <span class="n">googled</span> <span class="s2">&quot;how to make a directory in the</span>
<span class="n">Terminal</span><span class="s2">&quot; and found this page: http://guides.macrumors.com/Terminal. This</span>
<span class="n">pages</span> <span class="n">covers</span> <span class="n">some</span> <span class="n">useful</span> <span class="n">commands</span> <span class="k">for</span> <span class="n">working</span> <span class="n">the</span> <span class="ow">in</span> <span class="n">terminal</span> <span class="o">-</span> <span class="n">I</span> <span class="n">found</span>
<span class="n">mkdir</span> <span class="ow">and</span> <span class="n">cd</span> <span class="n">here</span><span class="o">.</span>

<span class="n">Exercise</span> <span class="mi">1</span>

<span class="n">This</span> <span class="n">exercise</span> <span class="n">was</span> <span class="n">easy</span><span class="o">.</span> <span class="n">Ran</span> <span class="n">into</span> <span class="n">one</span> <span class="n">issue</span> <span class="n">where</span> <span class="n">I</span> <span class="n">got</span> <span class="n">a</span> <span class="n">syntax</span> <span class="n">error</span>
<span class="n">because</span> <span class="n">I</span> <span class="n">used</span> <span class="n">a</span> <span class="n">double</span><span class="o">-</span><span class="n">quote</span> <span class="n">to</span> <span class="n">start</span> <span class="n">a</span> <span class="n">string</span> <span class="ow">and</span> <span class="n">a</span> <span class="n">single</span><span class="o">-</span><span class="n">quote</span> <span class="n">to</span>
<span class="n">end</span> <span class="n">a</span> <span class="n">string</span><span class="o">.</span> <span class="n">Easy</span> <span class="n">fix</span> <span class="n">once</span> <span class="n">I</span> <span class="n">figured</span> <span class="n">out</span> <span class="n">the</span> <span class="n">problem</span><span class="o">.</span>

<span class="n">Extra</span> <span class="n">credits</span><span class="p">:</span> <span class="mi">1</span><span class="p">)</span> <span class="n">Just</span> <span class="n">added</span> <span class="n">another</span> <span class="nb">print</span> <span class="n">statement</span><span class="p">;</span> <span class="mi">2</span><span class="p">)</span> <span class="n">Deleted</span> <span class="nb">all</span> <span class="n">of</span>
<span class="n">the</span> <span class="n">lines</span> <span class="k">except</span> <span class="k">for</span> <span class="n">one</span><span class="p">;</span> <span class="mi">3</span><span class="p">)</span> <span class="n">The</span> <span class="s1">&#39;#&#39;</span> <span class="n">symbol</span> <span class="n">causes</span> <span class="n">a</span> <span class="n">line</span> <span class="ow">not</span> <span class="n">to</span> <span class="n">be</span>
<span class="n">interpreted</span> <span class="o">-</span> <span class="k">if</span> <span class="n">you</span> <span class="n">add</span> <span class="n">this</span> <span class="n">to</span> <span class="n">the</span> <span class="n">line</span> <span class="n">everything</span> <span class="n">after</span> <span class="n">the</span> <span class="c1"># is ignored.</span>
<span class="n">I</span> <span class="n">figured</span> <span class="n">this</span> <span class="n">out</span> <span class="n">by</span> <span class="n">experimenting</span> <span class="k">with</span> <span class="n">putting</span> <span class="c1"># signs in my code and</span>
<span class="n">rerunning</span> <span class="n">it</span><span class="o">.</span> <span class="n">This</span> <span class="n">would</span> <span class="n">have</span> <span class="n">been</span> <span class="n">a</span> <span class="n">better</span> <span class="n">way</span> <span class="n">to</span> <span class="n">achieve</span> <span class="n">the</span> <span class="n">result</span> <span class="n">of</span>
<span class="n">exercise</span> <span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span>

<span class="n">Exercise</span> <span class="mi">2</span> <span class="p">(</span><span class="mi">1</span> <span class="n">Sept</span> <span class="mi">2011</span><span class="p">)</span>

<span class="n">No</span> <span class="n">problems</span> <span class="k">with</span> <span class="n">writing</span> <span class="ow">or</span> <span class="n">running</span> <span class="n">the</span> <span class="n">code</span><span class="o">.</span>

<span class="n">Extra</span> <span class="n">credits</span><span class="p">:</span> <span class="mi">1</span><span class="p">)</span> <span class="n">Yep</span><span class="p">,</span> <span class="n">I</span> <span class="n">was</span> <span class="n">right</span> <span class="n">about</span> <span class="n">what</span> <span class="n">the</span> <span class="s1">&#39;#&#39;</span> <span class="n">symbol</span> <span class="n">does</span><span class="o">.</span> <span class="mi">3</span><span class="p">)</span> <span class="n">Missed</span> <span class="n">a</span>
<span class="n">space</span> <span class="n">between</span> <span class="nb">print</span> <span class="ow">and</span> <span class="s2">&quot;This will run.&quot;</span> <span class="n">on</span> <span class="n">line</span> <span class="mi">9</span> <span class="n">when</span> <span class="n">re</span><span class="o">-</span><span class="n">entering</span> <span class="n">the</span> <span class="n">code</span><span class="o">.</span> <span class="n">This</span>
<span class="n">caused</span> <span class="n">a</span> <span class="n">syntax</span> <span class="n">error</span><span class="o">.</span>
</pre></div>
</div>
</div>
</div>


      </div>
      <div class="bottomnav" role="navigation" aria-label="bottom navigation">
      
        <p>
        «&#160;&#160;<a href="books_and_links.html">Books and recommended references</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="../../index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="application_presentations.html">Application presentations</a>&#160;&#160;»
        </p>

      </div>

    <div class="footer" role="contentinfo">
        &#169; Copyright 2019, J Gregory Caporaso.
      Last updated on Apr 03, 2020.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.4.0.
    </div>
  </body>
</html>
